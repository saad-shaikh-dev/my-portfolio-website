<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.18d7050c9b458edbc1f9.css" data-identity="gatsby-global-css">:root{--main-color:#0014a8;--secondary-color:#3f00ff;--dark-color:#444;--light-color:#fafafa}body{background-color:var(--light-color);color:var(--dark-color);font-family:Montserrat,sans-serif;font-size:16px;margin:70px 0 0;padding:1em 5em;text-align:justify}::selection{background:var(--main-color);color:var(--light-color)}h1,h2,h3{color:var(--main-color);font-family:Literata,serif}h2,h3{margin-bottom:0}p{line-height:1.5em}a{color:var(--dark-color);text-decoration:none}code{background-color:var(--secondary-color);border-radius:.5em;color:var(--light-color);display:block;font-family:Source Code Pro,monospace;padding:1em;white-space:pre-wrap}.small{font-size:small}.center-text{text-align:center}.bold{font-weight:700}.navbar{align-items:center;background-image:linear-gradient(-45deg,var(--main-color),var(--secondary-color),var(--main-color));border-bottom:3px solid var(--main-color);display:flex;height:70px;justify-content:space-around;left:0;position:fixed;top:0;width:100%;z-index:1}.navbar a,.navbar h1{color:var(--light-color);text-shadow:0 0 .5em var(--dark-color)}.navbar h1{font-size:2em}.navbar a{padding:.5em 1em;text-decoration:none}.navlinks a:hover{border-bottom:2.5px solid var(--light-color)}.home{display:flex;flex-flow:wrap;justify-content:space-around;margin:1em}.home div{margin:1em;text-align:left;width:clamp(288px,90%,500px)}.home-header h2{-webkit-background-clip:text;background-clip:text;background-image:linear-gradient(90deg,var(--main-color),var(--secondary-color),var(--main-color));color:transparent;font-size:4em;margin:0}.home-header h3{font-size:2em}.home-header-images{display:flex;flex-wrap:wrap;justify-content:center}.home-header-image{margin:1em;width:40%}.button-link{background-color:var(--secondary-color);border:1px solid var(--secondary-color);border-radius:.5em;color:var(--light-color);padding:.5em 1em;text-decoration:none}.button-link:hover{background-color:var(--light-color);border:1px solid var(--secondary-color);color:var(--secondary-color);transition-duration:.4s}.list-page h2,.list-page h3{text-align:center}.list-page h2{font-size:3em}.list-page h3{font-size:2em}.list{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center;margin:1em}.list-card{word-wrap:break-word;border-radius:.5em;box-shadow:0 0 .5em var(--main-color);margin:1em;padding:.25em 1em;width:clamp(288px,80vw,400px)}.list-card h4{border-bottom:2px solid var(--main-color);padding-bottom:.5em}.list-card:hover{box-shadow:0 0 .5em var(--secondary-color);transition-duration:.4s}.thumbnail{display:block;height:100px;margin-left:auto;margin-right:auto}.tools{font-style:italic}.description{height:45px}.link{color:var(--main-color)}.link:hover{color:var(--secondary-color)}.footer{text-align:center}@media only screen and (max-width:600px){body{margin-top:100px;padding:1em 1.5em}.navbar,body{transition-duration:.4s}.navbar{flex-direction:column;height:100px}.navbar h1{margin:.2em 0 0;transition-duration:.4s}.navlinks{margin-top:0;padding-top:0}}</style><meta name="generator" content="Gatsby 4.0.2"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">How to create an API that extracts data from websites - Saad Shaikh</title><meta data-react-helmet="true" charSet="utf-8"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=af4e5a995a28c9ff8765c5088b8bbe5a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=af4e5a995a28c9ff8765c5088b8bbe5a"/><link as="script" rel="preload" href="/webpack-runtime-040a23f0744802f8bc23.js"/><link as="script" rel="preload" href="/framework-84d4cafd658c7375599e.js"/><link as="script" rel="preload" href="/app-086b9e1319a64f7d673e.js"/><link as="script" rel="preload" href="/0166b4a0e340c91a4286c5a67fe0907194b7a8f4-f4283a97ca9662ea5a8a.js"/><link as="script" rel="preload" href="/component---src-templates-article-js-f7389b94cc5d737dbf24.js"/><link as="fetch" rel="preload" href="/page-data/my-articles/how-to-create-an-api-that-extracts-data-from-websites/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><nav class="navbar"><h1><a href="/">Saad Shaikh</a></h1><div class="navlinks" id="menu"><a href="/">Home</a><a href="/my-projects">My Projects</a><a href="/my-articles">My Articles</a></div></nav><div class="main"><div><h2 class="center-text">How to create an API that extracts data from websites</h2><p class="small bold">Date: <!-- -->22.10.2021</p><div><p>Hi, I am an aspiring we developer and I am going to show you how to create an API that aggregates data from various websites.</p>
<p>I will be using Node JS with the extensions axios, cheerio and express as well as nodemon for the development phase.</p>
<p>So here goes..</p>
<p>First, you make sure you have NodeJS installed. In order to do this, open a terminal and type the following command:</p>
<pre><code>sudo apt install nodejs
</code></pre>
<p>This command, checks if node is already installed. If it is, then it will tell you so, otherwise it will install it.</p>
<p>After that, you create a folder with the name of you API application. Mine is called “renewable-energy-news-api” in my desktop.</p>
<p>Then you navigate to the folder from the terminal using the command “cd [folder-address]”. Since mine is in the desktop I typed “cd Desktop/renewable-energy-news-api”.</p>
<p>Once you are in the newly created folder, you need to start installing some things. First, I suggest you open the project folder in your IDE of choice so you can see what’s happening.</p>
<p>The first thing you install is the package.json file. This file contains all the relevant information about the project. You can also use this file to create some command line shortcuts which are called scripts.</p>
<p>To install package.json, type “npm init” in the command line. As you may have noticed, I’m using the command line a lot. This is because it gets things done much faster. Anyway, once you have typed “npm init” and hit enter, you will be asked to fill up the details about the project. You can fill it up the way you want to. The only important part to fill is the “entry point”. Here you have to specify the name of the main file where all of your code will be and where all the other files will point to. Since this file does not exits yet, you can name it anything you want. I plan using the default name index.js, so I just hit enter the let the package.json file get created.</p>
<p>Now, we need to install some extensions. The extension we are going to install are axios, cheerio, express and nodemon. Axios is used to fetch data from a source, cheerio manipulates data structures, express connects nodejs to a server and nodemon automatically refreshes the application in the local server whenever we make any change to the back end code without needing to close and restart the server.</p>
<p>The syntax to install extensions from the command line is “npm install [extension-name]” or the shorter version “npm i [extension-name]”. You can also install multiple extensions simultaneously by leaving a space between each extension name. So I typed “npm i axios cheerio express nodemon” and hit enter, and voila, all the extensions were installed.</p>
<p>Now, let’s create a script to start the application locally so that we can see what it looks like before it is deployed. For that, you write the below code in the scripts property of the package.json file:</p>
<pre><code>"start": "nodemon index.js"
</code></pre>
<p>Alrighty, so let’s get to the meat of this project then. Now, we finally create the index.js file I was talking about before. Once you have created it, we can start coding.</p>
<p>In the index.js file, the first thing we do is import the extension we have installed and give it a local name. The syntax for that is “const [extension-local-name] = require(“[extension-name]”). Let’s type in the below code in the file:</p>
<pre><code>const express = require("express");
const axios = require("axios");
const cheerio = require("cheerio");
</code></pre>
<p>Next, you want to add the port to which the app will be deployed to. There will be two ports. One for local hosting (I will be using 5006) and one for the actual deployment. So you add:</p>
<pre><code>const port = process.env.PORT || 5006;
</code></pre>
<p>Now, you need to create a list of sources from where to get the news about renewable energy. For that, create an object called “newsSources” containing the details about these various news organizations:</p>
<pre><code>const newsSources = [
    {
        name: "telegraph",
        domain: "https://www.telegraph.co.uk",
        url: "https://www.telegraph.co.uk/renewable-energy/",
    },
    {
        name: "the-guardian",
        domain: "https://www.theguardian.com",
        url: "https://www.theguardian.com/environment/renewableenergy",
    },
    {
        name: "the-times",
        domain: "https://www.thetimes.co.uk",
        url: "https://www.thetimes.co.uk/search?source=search-page&#x26;q=renewable",
    },
    {
        name: "al-jazeera",
        domain: "https://www.aljazeera.com",
        url: "https://www.aljazeera.com/search/renewable"
    },
    {
        name: "recharge-news",
        domain: "https://www.rechargenews.com",
        url: "https://www.rechargenews.com/"
    },
    {
        name: "renewables-now",
        domain: "https://renewablesnow.com/news",
        url: "https://renewablesnow.com/"
    },
    {
        name: "science-daily",
        domain: "https://www.sciencedaily.com",
        url: "https://www.sciencedaily.com/search/?keyword=renewable#gsc.tab=0&#x26;gsc.q=renewable&#x26;gsc.page=1"
    },
    {
        name: "renewable-energy-magazine",
        domain: "https://www.renewableenergymagazine.com",
        url: "https://www.renewableenergymagazine.com/search?cx=partner-pub-7794467828055047%3A8692188386&#x26;cof=FORID%3A9&#x26;ie=UTF-8&#x26;q=renewable"
    },
    {
        name: "world-energy-news",
        domain: "https://www.worldenergynews.com",
        url: "https://www.worldenergynews.com/news/search?search=renewable"
    }
];
</code></pre>
<p>After that, you create a blank array to which will then store an object that holds all the latest renewable energy related news that has been extracted from the news sources listed in the “newsSources” object. I will call it “news”:</p>
<pre><code>const news = [];
</code></pre>
<p>Now, you will use express to connect to the server and create pages in the app. The default syntax to use express is “express()” but it is better to create a shorter version of the syntax for local use for faster coding. I will call the shortened form of “express()” as “app”:</p>
<pre><code>const app = express();
</code></pre>
<p>There will be three page types in the app,:</p>
<ul>
<li>The home page — this page gives a brief description about the application.</li>
<li>The news page — this page contains all the news about renewable energy from the various news sources.</li>
<li>The news pages from individual sources — these pages will contain renewable energy related news from the individual sources.</li>
</ul>
<p>We will create each page using a get request in express and then displaying the contents of the page in json format.</p>
<p>First, let’s create the home page. Mine will be a simple page that briefly describes the purpose of the site and provides a link to the news page. Obviously, you use the address “/” for this page. As you can see below, the link I entered is to the actual deployed app. However, since It does not exist yet for you, you can use the link “<a href="http://localhost:5006/news%E2%80%9D">http://localhost:5006/news”</a> instead.</p>
<pre><code>app.get("/", (action, reaction) => {
    reaction.json(`Hi, my name is Saad Shaikh and this is the climate change news API. Go to the link 'https://climate-change-feed-api.herokuapp.com/news' to get your news updates`);
});
</code></pre>
<p>Next, you need to create the news page. This is the most important page in the application. I will use the address “/news” for this page but you can name it whatever you want. First, you create a get request with the address “/news” (or anything else that you prefer). Then, you use the Javascript map function on the “newsSources” object to map through the verious news organisations and name each individual one “newsSource” (in case you can’t see it, it does not have an “s”). After that, you will use axios to connect to the urls in those news sources. These are the steps for using axios:</p>
<ul>
<li>Use the “get” request in axios to extract the website url of the individual news source from the “url” property in the object.</li>
<li>Use the “then” function to use the cheerio extension to extract all the links containing the word “renewable” and using its text and links to be added to the “news” array. You will also need to add a function to add the domain name to any of the links that just start with “/”.</li>
<li>Use the “catch” function to log any errors.</li>
</ul>
<p>Lastly, you convert the now filled up “news” array of object into JSON.</p>
<pre><code>app.get("/news", (action, reaction) => {
    newsSources.map(newsSource =>
        axios
            .get(newsSource.url)
            .then(response => {
                const html = response.data;
                const $ = cheerio.load(html);
                $('a:contains("renewable")', html).each(function () {
                    const title = $(this).text();
                    const url = $(this).attr("href");
                    const link = () => url.startsWith("/") ? newsSource.domain + url : url
                    news.push({ title, url: link(), source: newsSource.name });
                });
            })
            .catch(err => console.log(err))
    );
    reaction.json(news);
});
</code></pre>
<p>The last page request that is left to create now are the news pages from individual news sources. It is similar to the previous express request but you will also need to create separate Ids for each page and use the “params” function to get the data only from the individual sources.</p>
<pre><code>app.get("/news/:newsSourceId", (req, res) => {
    const newsSourceId = req.params.newsSourceId;
    const newsSourceAddress = newsSources.filter(
        newsSource => newsSource.name == newsSourceId
    )[0].url;
    axios
        .get(newsSourceAddress)
        .then(response => {
            const html = response.data;
            const $ = cheerio.load(html);
            const specificArticles = [];
            $('a:contains("renewable")', html).each(function () {
                const title = $(this).text();
                const url = $(this).attr("href");
                /*   const link = () => url.startsWith("/") ? newsSourceAddress.domain + url : url */
                specificArticles.push({ title, url, source: newsSourceId });
            });
            res.json(specificArticles)

        })
        .catch(err => console.log(err));
});
</code></pre>
<p>Yay! you’ve created all the pages.</p>
<p>Finally, the last piece of code you need to write is an express function to listen to all the above code and connect it to the actual ports that were shown in the beginning. This is how you do it:</p>
<pre><code>app.listen(port, () => console.log(`server running on port ${port}`));
</code></pre>
<p>Now let’s test if everything is working properly. Just type “npm start” in the terminal in your IDE (remember the script we had created?) and you application will open in “<a href="http://localhost:5006/%E2%80%9D">http://localhost:5006/”</a>. Go through the app to see if everything functions as intended. If it does, then we’re done.</p>
<p>And that’s it. You have created an API that gets news related to renewable energy from various sources. Congratulations :).</p>
<p>Now you are free to deploy your application to the hosting provider of your choice. I will write another article in the future on how to deploy applications to various hosting providers.</p>
<p>Till then, take care.</p></div><p>Source code: <a class="link" href="https://gitlab.com/saad.shaikh/renewable-energy-news-api" target="_blank" rel="noreferrer">https://gitlab.com/saad.shaikh/renewable-energy-news-api</a></p><p>Project link: <a class="link" href="https://renewable-energy-news-api.herokuapp.com/" target="_blank" rel="noreferrer">https://renewable-energy-news-api.herokuapp.com/</a></p></div></div><br/><footer class="footer"><p>I&#x27;m available for hire. You can contact me at <a class="link" href="mailto:saad.shaikh.dev@protonmail.com">saad.shaikh.dev@protonmail.com</a>.</p><p>This website was made by Saad Shaikh - Copyright 2021 Saad Shaikh</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-125961831-3', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/my-articles/how-to-create-an-api-that-extracts-data-from-websites";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-e83a50f28441c67b7768.js"],"app":["/app-086b9e1319a64f7d673e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-928400a50a8a89c5ec7c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-8dc70346661e44eb1647.js"],"component---src-pages-my-articles-js":["/component---src-pages-my-articles-js-504708bb4dcba55e7107.js"],"component---src-pages-my-projects-js":["/component---src-pages-my-projects-js-6c2f76c4214eac2a47c6.js"],"component---src-templates-article-js":["/component---src-templates-article-js-f7389b94cc5d737dbf24.js"]};/*]]>*/</script><script src="/polyfill-e83a50f28441c67b7768.js" nomodule=""></script><script src="/component---src-templates-article-js-f7389b94cc5d737dbf24.js" async=""></script><script src="/0166b4a0e340c91a4286c5a67fe0907194b7a8f4-f4283a97ca9662ea5a8a.js" async=""></script><script src="/app-086b9e1319a64f7d673e.js" async=""></script><script src="/framework-84d4cafd658c7375599e.js" async=""></script><script src="/webpack-runtime-040a23f0744802f8bc23.js" async=""></script></body></html>